# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

## [0.11.0]

### Added

- Conditional exports to support both ESM and CJS ([#592](https://github.com/MetaMask/delegator-sdk/pull/592))
- Utilities to simplify calls to `isValidSignature` ([#596](https://github.com/MetaMask/delegator-sdk/pull/596))
- New `MultiTokenPeriod` caveat and update `BalanceGte` enforcers to `BalanceChange` ([#595](https://github.com/MetaMask/delegator-sdk/pull/595))
- New `aggregateSignature()` function to generate multisig signatures ([#599](https://github.com/MetaMask/delegator-sdk/pull/599))
- Add gnosis chiado testnet ([#594](https://github.com/MetaMask/delegator-sdk/pull/594))

## [0.10.2]

### Fixed

- Remove ESM exports to force CJS resolution ([#590](https://github.com/MetaMask/delegator-sdk/pull/590))
- Fix issue in Firefox where excluding optional properties in ERC-7715 request caused the request to fail ([#589](https://github.com/MetaMask/delegator-sdk/pull/589))

## [0.10.1]

### Fixed

- Allow optional permission properties to be either null _or_ undefined ([#586](https://github.com/MetaMask/delegator-sdk/pull/586))

## [0.10.0]

### Added

- Add support for optional isAdjustmentAllowed on the top level of the permissionsRequest object ([#583](https://github.com/MetaMask/delegator-sdk/pull/583))

### Changed

- Update README for Delegation Toolkit ([#584](https://github.com/MetaMask/delegator-sdk/pull/584))
- Rename permissions snaps with -snap suffix ([#582](https://github.com/MetaMask/delegator-sdk/pull/582))
- Move auto-changelog to dev dependency ([#581](https://github.com/MetaMask/delegator-sdk/pull/581))

## [0.9.0]

### Added

- Add MIT+APACHE-2 license ([#554](https://github.com/MetaMask/delegator-sdk/pull/554))

### Changed

- Rename package from `@metamask-private/delegator-core-viem` to `@metamask/delegation-toolkit` ([#551](https://github.com/MetaMask/delegator-sdk/pull/551), [#537](https://github.com/MetaMask/delegator-sdk/pull/537))
- Rename references to snaps used in experimental 7715 actions ([#553](https://github.com/MetaMask/delegator-sdk/pull/553))

## [0.8.1]

### Uncategorized

- Actually typecheck the build, fix resulting issues (mostly in tests) ([#548](https://github.com/MetaMask/delegator-sdk/pull/548))

## [0.8.0]

### Uncategorized

- Revert "0.8.0 (#543)" ([#543](https://github.com/MetaMask/delegator-sdk/pull/543))
- 0.8.0 ([#543](https://github.com/MetaMask/delegator-sdk/pull/543))
- Public interface should accept object params ([#539](https://github.com/MetaMask/delegator-sdk/pull/539))
- Add mitigation for malicious accountMetadata and corresponding test. ([#541](https://github.com/MetaMask/delegator-sdk/pull/541))
- Upgrade/fw 1.3.0 ([#522](https://github.com/MetaMask/delegator-sdk/pull/522))
- Delegation salt is now Hex type. ([#536](https://github.com/MetaMask/delegator-sdk/pull/536))
- Define default type for TImplementation parameter ([#535](https://github.com/MetaMask/delegator-sdk/pull/535))

## [0.7.1]

### Uncategorized

- Wait on the check to ensure snaps are correctly configured before sub… ([#529](https://github.com/MetaMask/delegator-sdk/pull/529))
- `justification` is required parameter in `native-token-stream` ([#527](https://github.com/MetaMask/delegator-sdk/pull/527))

## [0.7.0]

### Uncategorized

- Add actions to experimental namespace for redeeming delegations ([#520](https://github.com/MetaMask/delegator-sdk/pull/520))
- Move delegation storage logic to experimental namespace in delegator-core-viem ([#521](https://github.com/MetaMask/delegator-sdk/pull/521))
- FactoryData should be hex ([#519](https://github.com/MetaMask/delegator-sdk/pull/519))
- Implement basic 7715 grant permissions action ([#515](https://github.com/MetaMask/delegator-sdk/pull/515))

## [0.6.1]

## [0.6.0]

### Uncategorized

- Update delegation framework to 1.2.0 ([#502](https://github.com/MetaMask/delegator-sdk/pull/502))

## [0.5.1]

## [0.4.0]

### Uncategorized

- Rename toDeleGatorSmartAccount to toMetaMaskSmartAccount (and related renames), create MetaMaskSmartAccount type alias for ToMetaMaskSmartAccountReturnType. ([#492](https://github.com/MetaMask/delegator-sdk/pull/492))
- Delegation Framework Contract Utils ([#489](https://github.com/MetaMask/delegator-sdk/pull/489))
- Removes `DeleGatorClient` and related cruft from SDK ([#486](https://github.com/MetaMask/delegator-sdk/pull/486))
- feat: Add support for Viem's account abstraction tooling ([#481](https://github.com/MetaMask/delegator-sdk/pull/481))

## [0.3.1]

### Uncategorized

- Smaller Changeset ([#483](https://github.com/MetaMask/delegator-sdk/pull/483))
- Add support for webauthn signatory ([#479](https://github.com/MetaMask/delegator-sdk/pull/479))
- Change viem dependency to be peer - add as a dependency at the top level to ensure it's installed locally ([#480](https://github.com/MetaMask/delegator-sdk/pull/480))
- Correctly export from DeleGatorSmartAccount, so that getDeleGatorAddress() function is available from delegator-core-viem. Add e2e test to verify getDeleGatorAddress() is available and functions correctly. ([#477](https://github.com/MetaMask/delegator-sdk/pull/477))
- End to end tests for caveats ([#448](https://github.com/MetaMask/delegator-sdk/pull/448))

## [0.3.0]

### Uncategorized

- Add `getDeleGatorAddress()` to `DeleGatorSmartAccount` ([#445](https://github.com/MetaMask/delegator-sdk/pull/445))
- Add 'environment' property to delegator client type, and return value of createDeleGatorClient. Add tests. ([#447](https://github.com/MetaMask/delegator-sdk/pull/447))
- feat: exposed function to retrieve delegations by deleGatorAddress ([#404](https://github.com/MetaMask/delegator-sdk/pull/404))
- chore: adds a yarn / turbo clean script ([#424](https://github.com/MetaMask/delegator-sdk/pull/424))
- Accept CaveatBuilderConfig parameter when creating CaveatBuilder via DeleGatorClient. ([#428](https://github.com/MetaMask/delegator-sdk/pull/428))

## [0.2.0]

### Uncategorized

- Updating the Contract Interfaces ([#397](https://github.com/MetaMask/delegator-sdk/pull/397))
- Create delegations with caveats to CaveatBuilder ([#409](https://github.com/MetaMask/delegator-sdk/pull/409))
- Improve allowedMethodsBuilder to accept either 4byte selector, functi… ([#406](https://github.com/MetaMask/delegator-sdk/pull/406))
- Remove testHelpers.ts which introduced some mocks to help testing window interactions ([#411](https://github.com/MetaMask/delegator-sdk/pull/411))
- Adds missing Caveat builders ([#386](https://github.com/MetaMask/delegator-sdk/pull/386))
- 0.1.1 ([#384](https://github.com/MetaMask/delegator-sdk/pull/384))

## [0.1.1]

### Uncategorized

- Renames createInvokeUserOp to createRedeemDelegationUserOp ([#383](https://github.com/MetaMask/delegator-sdk/pull/383))
- 0.1.0 ([#382](https://github.com/MetaMask/delegator-sdk/pull/382))

## [0.1.0]

### Uncategorized

- Updating .yarnrc.yml to skip --immutable during CI ([#381](https://github.com/MetaMask/delegator-sdk/pull/381))
- 0.1.0 ([#380](https://github.com/MetaMask/delegator-sdk/pull/380))
- fix: reverts version and yarn regen step + adds potential publishing step fix ([#379](https://github.com/MetaMask/delegator-sdk/pull/379))
- 0.1.0 ([#367](https://github.com/MetaMask/delegator-sdk/pull/367))
- fix: dropping package version numbers to resolve release issue ([#366](https://github.com/MetaMask/delegator-sdk/pull/366))
- 0.1.0 ([#363](https://github.com/MetaMask/delegator-sdk/pull/363))
- Repo Cleanup ([#353](https://github.com/MetaMask/delegator-sdk/pull/353))
- Implements Signatory Agent architecture in `delegator-core-sdk` ([#341](https://github.com/MetaMask/delegator-sdk/pull/341))
- Update to v1.0.0 Contracts (June Audit) ([#337](https://github.com/MetaMask/delegator-sdk/pull/337))
- Fix JSDoc description to satisfy lint warning ([#356](https://github.com/MetaMask/delegator-sdk/pull/356))
- Fix 4 lint warnings in delegator-core-viem ([#355](https://github.com/MetaMask/delegator-sdk/pull/355))
- Reduce lint warnings in delegator-core-viem ([#350](https://github.com/MetaMask/delegator-sdk/pull/350))
- Create a `CaveatBuilder` with core caveat builders ([#284](https://github.com/MetaMask/delegator-sdk/pull/284))
- Queue RPC Requests ([#306](https://github.com/MetaMask/delegator-sdk/pull/306))
- 0.0.20 ([#317](https://github.com/MetaMask/delegator-sdk/pull/317))

## [0.0.20]

### Uncategorized

- Fix JSDoc lint issues as per 'jsdoc/match-description' rule ([#302](https://github.com/MetaMask/delegator-sdk/pull/302))
- Fix lint issues related to unhandled promises ([#298](https://github.com/MetaMask/delegator-sdk/pull/298))
- Delegation Sessions ([#275](https://github.com/MetaMask/delegator-sdk/pull/275))
- feat: added function to calculate responseTypeLocation ([#238](https://github.com/MetaMask/delegator-sdk/pull/238))
- 0.0.19 ([#300](https://github.com/MetaMask/delegator-sdk/pull/300))

## [0.0.19]

### Uncategorized

- chore: Autofix linting issues ([#286](https://github.com/MetaMask/delegator-sdk/pull/286))
- Allow caller to set authority, add tests for signDelegation action. ([#297](https://github.com/MetaMask/delegator-sdk/pull/297))
- Add `sendUserOperation` action and `useSendUserOperation` hook ([#244](https://github.com/MetaMask/delegator-sdk/pull/244))
- Fix lint issue: Rename primaryType to PrimaryType to match PascalCase ([#288](https://github.com/MetaMask/delegator-sdk/pull/288))
- Adds ability to configure an owner account to sign on behalf of DeleGator account in Wagmi ([#269](https://github.com/MetaMask/delegator-sdk/pull/269))
- Support EOA signer in delegator core viem client ([#267](https://github.com/MetaMask/delegator-sdk/pull/267))
- Created Shared Code Package ([#270](https://github.com/MetaMask/delegator-sdk/pull/270))
- 0.0.18 ([#266](https://github.com/MetaMask/delegator-sdk/pull/266))

## [0.0.18]

### Uncategorized

- Storing Delegations After Signing Them ([#253](https://github.com/MetaMask/delegator-sdk/pull/253))
- 0.0.17 ([#249](https://github.com/MetaMask/delegator-sdk/pull/249))

## [0.0.17]

### Uncategorized

- Rock Paper Scissors Demo ([#216](https://github.com/MetaMask/delegator-sdk/pull/216))
- wallet_passkeySignTypedData now performs a "standard" SignTypedData ([#236](https://github.com/MetaMask/delegator-sdk/pull/236))
- Add Delegation functionality ([#188](https://github.com/MetaMask/delegator-sdk/pull/188))
- Paymaster middleware, and Pimlico Verifying Paymaster ([#233](https://github.com/MetaMask/delegator-sdk/pull/233))
- 0.0.16 ([#222](https://github.com/MetaMask/delegator-sdk/pull/222))

## [0.0.16]

### Uncategorized

- Fix gas estimation ([#214](https://github.com/MetaMask/delegator-sdk/pull/214))
- Sending useroperations to the bundler ([#203](https://github.com/MetaMask/delegator-sdk/pull/203))
- Fix signing of usersops. Add corresponding tests. ([#196](https://github.com/MetaMask/delegator-sdk/pull/196))
- Add v0.0.3 Deployments & Decouple DeleGatorEnvironment Type ([#182](https://github.com/MetaMask/delegator-sdk/pull/182))
- feat: added test coverage for webauthn ([#184](https://github.com/MetaMask/delegator-sdk/pull/184))
- Set factory and factoryData on userOperations created by counterfactual clients. ([#178](https://github.com/MetaMask/delegator-sdk/pull/178))
- Replace jest with vitest, add anvil-js and initial environment setup ([#179](https://github.com/MetaMask/delegator-sdk/pull/179))
- Hook up signing for Hybrid Delegator ([#157](https://github.com/MetaMask/delegator-sdk/pull/157))
- SCA management utils functions ([#114](https://github.com/MetaMask/delegator-sdk/pull/114))
- Migrate EW Client ([#158](https://github.com/MetaMask/delegator-sdk/pull/158))
- Shared Internal Code ([#148](https://github.com/MetaMask/delegator-sdk/pull/148))
- Simplify signer, throw when accessing publicKey or attempting to signTransaction ([#155](https://github.com/MetaMask/delegator-sdk/pull/155))
- Introduce concept of per-implementation client config, Hybrid contract demands PassKeyBroker. Pass GetPassKeyBehaviour argument to passkey service in PassKeyBroker. ([#151](https://github.com/MetaMask/delegator-sdk/pull/151))
- 0.0.15 ([#146](https://github.com/MetaMask/delegator-sdk/pull/146))

## [0.0.15]

### Uncategorized

- 0.0.14 ([#145](https://github.com/MetaMask/delegator-sdk/pull/145))

## [0.0.14]

### Uncategorized

- 0.0.13 ([#143](https://github.com/MetaMask/delegator-sdk/pull/143))

## [0.0.13]

### Uncategorized

- 0.0.12 ([#142](https://github.com/MetaMask/delegator-sdk/pull/142))

## [0.0.12]

### Uncategorized

- feat : npm publish ([#141](https://github.com/MetaMask/delegator-sdk/pull/141))

## [0.0.11]

## [0.0.10]

## [0.0.9]

## [0.0.8]

### Uncategorized

- chore : cicd changelogs
- 0.0.7 ([#136](https://github.com/MetaMask/delegator-sdk/pull/136))
- 0.0.6 ([#135](https://github.com/MetaMask/delegator-sdk/pull/135))
- 0.0.5 ([#133](https://github.com/MetaMask/delegator-sdk/pull/133))
- 0.0.3 ([#131](https://github.com/MetaMask/delegator-sdk/pull/131))
- CICD Release process hardening ([#130](https://github.com/MetaMask/delegator-sdk/pull/130))
- npm-internal ([#127](https://github.com/MetaMask/delegator-sdk/pull/127))
- DeleGator Wagmi Connector ([#117](https://github.com/MetaMask/delegator-sdk/pull/117))
- Update build deps & format repo ([#119](https://github.com/MetaMask/delegator-sdk/pull/119))
- Updating to the last DeleGator and Paymaster changes, including 4337 updates ([#112](https://github.com/MetaMask/delegator-sdk/pull/112))
- feat: Implement PassKeyBroker ([#108](https://github.com/MetaMask/delegator-sdk/pull/108))
- Deleted the delegator core ethers folder, and references ([#110](https://github.com/MetaMask/delegator-sdk/pull/110))
- feat: Support counterfactual smart contract accounts in viem-core ([#94](https://github.com/MetaMask/delegator-sdk/pull/94))
- Support implementation specific behaviour ([#92](https://github.com/MetaMask/delegator-sdk/pull/92))
- Initial implementation of `core-viem` client ([#89](https://github.com/MetaMask/delegator-sdk/pull/89))
- Add initial boilerplate and scripts for delegator-core-viem package ([#79](https://github.com/MetaMask/delegator-sdk/pull/79))

[Unreleased]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.11.0...HEAD
[0.11.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.10.2...@metamask/delegation-toolkit@0.11.0
[0.10.2]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.10.1...@metamask/delegation-toolkit@0.10.2
[0.10.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.10.0...@metamask/delegation-toolkit@0.10.1
[0.10.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.9.0...@metamask/delegation-toolkit@0.10.0
[0.9.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.8.1...@metamask/delegation-toolkit@0.9.0
[0.8.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.8.0...@metamask/delegation-toolkit@0.8.1
[0.8.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.7.1...@metamask/delegation-toolkit@0.8.0
[0.7.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.7.0...@metamask/delegation-toolkit@0.7.1
[0.7.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.6.1...@metamask/delegation-toolkit@0.7.0
[0.6.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.6.0...@metamask/delegation-toolkit@0.6.1
[0.6.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.5.1...@metamask/delegation-toolkit@0.6.0
[0.5.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.4.0...@metamask/delegation-toolkit@0.5.1
[0.4.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.3.1...@metamask/delegation-toolkit@0.4.0
[0.3.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.3.0...@metamask/delegation-toolkit@0.3.1
[0.3.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.2.0...@metamask/delegation-toolkit@0.3.0
[0.2.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.1.1...@metamask/delegation-toolkit@0.2.0
[0.1.1]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.1.0...@metamask/delegation-toolkit@0.1.1
[0.1.0]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.20...@metamask/delegation-toolkit@0.1.0
[0.0.20]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.19...@metamask/delegation-toolkit@0.0.20
[0.0.19]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.18...@metamask/delegation-toolkit@0.0.19
[0.0.18]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.17...@metamask/delegation-toolkit@0.0.18
[0.0.17]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.16...@metamask/delegation-toolkit@0.0.17
[0.0.16]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.15...@metamask/delegation-toolkit@0.0.16
[0.0.15]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.14...@metamask/delegation-toolkit@0.0.15
[0.0.14]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.13...@metamask/delegation-toolkit@0.0.14
[0.0.13]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.12...@metamask/delegation-toolkit@0.0.13
[0.0.12]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.11...@metamask/delegation-toolkit@0.0.12
[0.0.11]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.10...@metamask/delegation-toolkit@0.0.11
[0.0.10]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.9...@metamask/delegation-toolkit@0.0.10
[0.0.9]: https://github.com/MetaMask/delegator-sdk/compare/@metamask/delegation-toolkit@0.0.8...@metamask/delegation-toolkit@0.0.9
[0.0.8]: https://github.com/MetaMask/delegator-sdk/releases/tag/@metamask/delegation-toolkit@0.0.8
